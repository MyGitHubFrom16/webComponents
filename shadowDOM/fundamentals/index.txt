Чтобы создать shadow-dom нужно
1) Найти shadow host - элемент в который буду вставлять дом
2) создать shadow root - первый тег с которого начинается shadow dom
3) добавить элементы

На самом деле shadow dom не инкапсулирует js полностью, просто не дает работать с элементами внутри него извне.